!function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?module.exports=n():e.nativeSchema=n()}(this,function(){var e={isAndroid:function(){return navigator.userAgent.match(/Android/i)?!0:!1},isMobileQQ:function(){var e=navigator.userAgent;return/(iPad|iPhone|iPod).*? (IPad)?QQ\/([\d\.]+)/.test(e)||/\bV1_AND_SQI?_([\d\.]+)(.*? QQ\/([\d\.]+))?/.test(e)},isIOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)?!0:!1},isWx:function(){return navigator.userAgent.match(/micromessenger/i)?!0:!1}},n={PROTOCAL:"xxxx",HOME:"xxxx",FAILBACK:{ANDROID:"http://a.app.qq.com/o/simple.jsp?pkgname=cn.futu.trader&g_f=991653",IOS:"http://a.app.qq.com/o/simple.jsp?pkgname=cn.futu.trader&g_f=991653"},APK_INFO:{PKG:"cn.xx.xx",CATEGORY:"android.intent.category.DEFAULT",ACTION:"android.intent.action.VIEW"},LOAD_WAITING:3e3},i=window.navigator.userAgent,t=(i.match(/Chrome\/([\d.]+)/)||i.match(/CriOS\/([\d.]+)/))&&e.isAndroid()&&!e.isMobileQQ();return{mixinConfig:function(i){i&&(n.PROTOCAL=i.protocal||n.PROTOCAL,n.schema=i.schema||n.HOME,n.LOAD_WAITING=i.loadWaiting||n.LOAD_WAITING,e.isIOS()?n.FAILBACK.IOS=i.failUrl||n.FAILBACK.IOS:e.isAndroid()&&(n.FAILBACK.ANDROID=i.failUrl||n.FAILBACK.ANDROID,n.APK_INFO=i.apkInfo||n.APK_INFO))},generateSchema:function(e){var i=(window.location.href,"");return i=e?e:n.HOME,i=t?"intent://"+i+"#Intent;scheme="+n.PROTOCAL+";package="+n.APK_INFO.PKG+";category="+n.APK_INFO.CATEGORY+";action="+n.APK_INFO.ACTION+";S.browser_fallback_url="+encodeURIComponent(n.FAILBACK.ANDROID)+";end":n.PROTOCAL+"://"+i},loadSchema:function(i){this.mixinConfig(i);var o=this.generateSchema(n.schema),a=document.createElement("iframe"),d=document.createElement("a"),r=document.body,c=null;d.style.cssText=a.style.cssText="display:none;width:0px;height:0px;",e.isWx()&&e.isAndroid()?window.location.href=n.FAILBACK.ANDROID:e.isIOS()?e.isWx()?window.location.href=n.FAILBACK.IOS:(d.href=o,r.appendChild(d),d.click()):t?(d.href=o,r.appendChild(d),d.click()):(r.appendChild(a),a.src=o);var A=Date.now();c=setTimeout(function(){document.hidden||document.webkitHidden||Date.now()-A>n.LOAD_WAITING+200||(window.location.href=e.isIOS()?n.FAILBACK.IOS:n.FAILBACK.ANDROID)},n.LOAD_WAITING);var s=function(){var e=document.hidden||document.webkitHidden;e&&clearTimeout(c)};document.addEventListener("visibilitychange",s,!1),document.addEventListener("webkitvisibilitychange",s,!1),window.addEventListener("pagehide",function(){clearTimeout(c)},!1)}}});